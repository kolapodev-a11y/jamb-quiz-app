<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="JAMB UTME Quiz Practice App" />
  <title>JAMB UTME Quiz App</title>

  <link rel="stylesheet" href="styles.css" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>

  <!-- âœ… POPUNDER SCRIPT â€“ FRESH FROM ADSTERRA (MUST BE IN <head>) -->
  <script data-cfasync="false" async
    src="https://pl28720963.effectivegatecpm.com/4c/0d/c5/4c0dc5d49cbe558de9d8f0ca616da2c0.js">
  </script>

  <!-- âœ… SOCIAL BAR STYLING (CRITICAL FOR VISIBILITY) -->
  <style>
    #adsterra-social-bar {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      z-index: 2147483647 !important;
      background: transparent !important;
      overflow: visible !important;
      min-height: 60px !important;
      display: block !important;
    }
    #adsterra-social-bar:not(:empty) {
      min-height: 60px !important;
    }
    #adsterra-social-bar > * {
      display: block !important;
      width: 100% !important;
      height: 100% !important;
      max-height: 60px !important;
    }
    #adsterra-social-bar::after {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      right: 0;
      height: 2px;
      background: rgba(0,0,0,0.1);
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
  </style>
</head>

<body>
  <!-- âœ… SOCIAL BAR CONTAINER â€“ MUST BE FIRST CHILD OF <body> -->
  <div id="adsterra-social-bar" class="adsterra-social-bar"></div>

  <!-- Home Screen -->
  <div id="home-screen" class="screen active">
    <div class="container">
      <header class="app-header">
        <div class="logo">
          <h1>ğŸ“ JAMB UTME</h1>
          <p>Practice Quiz</p>
        </div>
      </header>

      <div class="mode-selection">
        <h2>Select Quiz Mode</h2>

        <h3 style="color:#1a472a; margin:20px 0 10px; font-size:18px;">ğŸ“š Multi-Subject Practice</h3>
        <div class="mode-cards">
          <div class="mode-card" data-mode="test">
            <div class="mode-icon">ğŸ“</div>
            <h3>Test Mode</h3>
            <p>10 questions per subject</p>
            <p class="mode-detail">English + 3 subjects Â· 26 mins</p>
            <button class="btn btn-primary" onclick="selectMode('test', false)">Start Test</button>
          </div>

          <div class="mode-card" data-mode="exam">
            <div class="mode-icon">ğŸ¯</div>
            <h3>Exam Mode</h3>
            <p>60 English + 40 Others</p>
            <p class="mode-detail">Full JAMB simulation Â· 2 hours</p>
            <button class="btn btn-primary" onclick="selectMode('exam', false)">Start Exam</button>
          </div>
        </div>

        <h3 style="color:#667eea; margin:30px 0 10px; font-size:18px;">ğŸ“– Single Subject Practice</h3>
        <div class="mode-cards">
          <div class="mode-card single-subject-card" data-mode="single-test">
            <div class="mode-icon">ğŸ“„</div>
            <h3>Subject Test</h3>
            <p>20 questions</p>
            <p class="mode-detail">One subject only Â· 14 mins</p>
            <button class="btn btn-secondary" onclick="selectMode('test', true)">Start Subject Test</button>
          </div>

          <div class="mode-card single-subject-card" data-mode="single-exam">
            <div class="mode-icon">ğŸ“</div>
            <h3>Subject Exam</h3>
            <p>40 questions</p>
            <p class="mode-detail">Deep practice mode Â· 27 mins</p>
            <button class="btn btn-secondary" onclick="selectMode('exam', true)">Start Subject Exam</button>
          </div>
        </div>
      </div>

      <div class="stats-section">
        <h3>Your Statistics</h3>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="totalQuizzes">0</div>
            <div class="stat-label">Quizzes Taken</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="avgScore">0%</div>
            <div class="stat-label">Average Score</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="bestScore">0%</div>
            <div class="stat-label">Best Score</div>
          </div>
        </div>

        <div class="contact-section" style="margin-top:40px; padding-top:20px; border-top:1px solid #eee; text-align:center;">
          <h3>Need Help? ğŸ¤</h3>
          <p>For enquiries, support, or feedback, contact us via WhatsApp:</p>

          <a href="https://wa.me/2349050911921"
             target="_blank"
             class="btn btn-whatsapp"
             style="display:inline-flex; align-items:center; gap:8px; text-decoration:none; margin-top:10px;">
            <img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="WhatsApp" width="20" height="20">
            Message Us on WhatsApp
          </a>

          <p style="font-size:12px; color:#666; margin-top:8px;">We respond within 24 hours.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Subject Selection Screen -->
  <div id="subject-screen" class="screen">
    <div class="container">
      <div class="screen-header">
        <button class="btn-back" onclick="goHome()">â† Back</button>
        <h2>Select Subjects</h2>
      </div>

      <div class="subject-selection">
        <div class="subject-note">
          <p>ğŸ“Œ English is <strong>compulsory</strong>. Select 3 more subjects.</p>
          <p class="mode-info" id="modeInfo"></p>
        </div>

        <div class="subjects-grid">
          <div class="subject-card compulsory" data-subject="english">
            <div class="subject-icon">ğŸ“š</div>
            <h3>English</h3>
            <p class="compulsory-badge">Compulsory</p>
            <input type="checkbox" class="subject-checkbox" checked disabled>
          </div>

          <div class="subject-card" data-subject="mathematics"><div class="subject-icon">ğŸ”¢</div><h3>Mathematics</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="physics"><div class="subject-icon">âš›ï¸</div><h3>Physics</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="chemistry"><div class="subject-icon">ğŸ§ª</div><h3>Chemistry</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="biology"><div class="subject-icon">ğŸ§¬</div><h3>Biology</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="government"><div class="subject-icon">ğŸ›ï¸</div><h3>Government</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="economics"><div class="subject-icon">ğŸ’°</div><h3>Economics</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="literature"><div class="subject-icon">ğŸ“–</div><h3>Literature</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="commerce"><div class="subject-icon">ğŸ¢</div><h3>Commerce</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="accounting"><div class="subject-icon">ğŸ“Š</div><h3>Accounting</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="crs"><div class="subject-icon">âœï¸</div><h3>CRS</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="history"><div class="subject-icon">ğŸ›ï¸</div><h3>History</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="geography"><div class="subject-icon">ğŸŒ</div><h3>Geography</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="marketing"><div class="subject-icon">ğŸ“¢</div><h3>Marketing</h3><input type="checkbox" class="subject-checkbox"></div>
          <div class="subject-card" data-subject="agric"><div class="subject-icon">ğŸŒ¾</div><h3>Agric</h3><input type="checkbox" class="subject-checkbox"></div>
        </div>

        <div class="selection-info">
          <p>Selected: <span id="selectedCount">1</span> / <span id="maxCount">4</span></p>
        </div>

        <button class="btn btn-primary btn-large" id="startQuizBtn" onclick="startQuiz()">
          Start Quiz â†’
        </button>
      </div>
    </div>
  </div>

  <!-- Quiz Screen -->
  <div id="quiz-screen" class="screen">
    <div class="quiz-header">
      <div class="quiz-info">
        <div class="timer" id="timer">
          <span class="timer-icon">â±ï¸</span>
          <span id="timeDisplay">00:00</span>
        </div>
        <div class="progress-info">
          <span id="currentQuestion">1</span> / <span id="totalQuestions">0</span>
        </div>
      </div>
      <div class="subject-indicator" id="currentSubject"></div>
    </div>

    <div class="quiz-container">
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>

      <div class="question-section">
        <div class="question-number">Question <span id="qNumber">1</span></div>
        <div class="passage-box" id="passageBox" style="display:none;"></div>
        <div class="question-text" id="questionText"></div>
        <div class="options-container" id="optionsContainer"></div>
      </div>

      <div class="quiz-navigation">
        <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">â† Previous</button>
        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">Next â†’</button>
        <button class="btn btn-success" id="submitBtn" onclick="submitQuiz()" style="display:none;">Submit Quiz</button>
      </div>

      <div class="question-navigator">
        <button class="btn-toggle-nav" onclick="toggleNavigator()">ğŸ“‹ Question Navigator</button>
        <div class="nav-grid" id="navGrid"></div>
      </div>
    </div>
  </div>

  <!-- Results Screen -->
  <div id="results-screen" class="screen">
    <div class="container">
      <div class="results-container">
        <div class="results-header">
          <div class="results-icon">ğŸ‰</div>
          <h2>Quiz Completed!</h2>
        </div>

        <div class="score-display">
          <div class="score-circle">
            <svg width="200" height="200">
              <circle cx="100" cy="100" r="90" class="score-bg"></circle>
              <circle cx="100" cy="100" r="90" class="score-progress" id="scoreCircle"></circle>
            </svg>
            <div class="score-text">
              <div class="score-percentage" id="scorePercentage">0%</div>
              <div class="score-label">Score</div>
            </div>
          </div>
        </div>

        <div class="results-summary">
          <div class="summary-card correct"><div class="summary-icon">âœ…</div><div class="summary-value" id="correctCount">0</div><div class="summary-label">Correct</div></div>
          <div class="summary-card wrong"><div class="summary-icon">âŒ</div><div class="summary-value" id="wrongCount">0</div><div class="summary-label">Wrong</div></div>
          <div class="summary-card unanswered"><div class="summary-icon">â­•</div><div class="summary-value" id="unansweredCount">0</div><div class="summary-label">Unanswered</div></div>
        </div>

        <!-- âœ… NATIVE BANNER AD -->
        <div class="ad-container">
          <div id="container-c7bf2117c3372e12237c88be59428594"></div>
          <script async="async" data-cfasync="false"
            src="https://pl28715421.effectivegatecpm.com/c7bf2117c3372e12237c88be59428594/invoke.js">
          </script>
        </div>

        <div class="subject-breakdown" id="subjectBreakdown"></div>

        <div class="results-actions">
          <button class="btn btn-primary" onclick="reviewAnswers()">ğŸ“ Review Questions</button>
          <button class="btn btn-secondary" onclick="openSmartlinkThen(goHome)">ğŸ  Home</button>
          <button class="btn btn-success" onclick="openSmartlinkThen(retakeQuiz)">ğŸ”„ Retake Quiz</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Review Screen -->
  <div id="review-screen" class="screen">
    <div class="container">
      <div class="screen-header">
        <button class="btn-back" onclick="backToResults()">â† Back to Results</button>
        <h2>Review Answers</h2>
      </div>

      <div class="review-filters">
        <button class="filter-btn active" data-filter="all" onclick="filterReview('all')">All (<span id="filterAll">0</span>)</button>
        <button class="filter-btn" data-filter="correct" onclick="filterReview('correct')">âœ… Correct (<span id="filterCorrect">0</span>)</button>
        <button class="filter-btn" data-filter="wrong" onclick="filterReview('wrong')">âŒ Wrong (<span id="filterWrong">0</span>)</button>
        <button class="filter-btn" data-filter="unanswered" onclick="filterReview('unanswered')">â­• Unanswered (<span id="filterUnanswered">0</span>)</button>
      </div>
          <!-- âœ… REVIEW PAGE BANNER -->
      <div class="ad-container" style="margin:20px 0;text-align:center;">
        <script>
         atOptions = {
        'key' : '468fee377aa2807ae0adffda686a26d7',
        'format' : 'iframe',
        'height' : 250,
        'width' : 300,
        'params' : {}
        };
        </script>
        <script src="https://www.highperformanceformat.com/468fee377aa2807ae0adffda686a26d7/invoke.js"></script>
      </div>


      <div class="review-container" id="reviewContainer"></div>
    </div>
  </div>

  <script src="app.js"></script>
  <script src="quiz.js"></script>

  <script>
    // Smartlink helper
    const SMARTLINK_URL = 'https://www.effectivegatecpm.com/v31zhyhy8w?key=58401952550308bcd5c3c4a3f2bfe14d';
    function openSmartlinkThen(callback) {
      try { window.open(SMARTLINK_URL, '_blank'); } catch(e) {}
      if (typeof callback === 'function') callback();
    }

    // âœ… POPUNDER ARMING â€“ on first real user gesture
    (function() {
      let armed = false;
      const arm = () => {
        if (!armed) {
          armed = true;
          console.log('Popunder armed via user interaction');
        }
      };
      ['click', 'touchstart', 'pointerdown'].forEach(type =>
        document.addEventListener(type, arm, { once: true, capture: true })
      );
    })();

    // âœ… DEFERRED SOCIAL BAR LOADER â€“ using FRESH script URL
    (function() {
      const loadSocialBar = () => {
        const script = document.createElement('script');
        script.src = 'https://pl28716036.effectivegatecpm.com/53/08/6e/53086e6c1a10c92e09c2b4b302e9bb0f.js';
        script.async = true;
        script.setAttribute('data-cfasync', 'false');
        document.body.appendChild(script);
      };

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadSocialBar);
      } else {
        loadSocialBar();
      }
    })();
  </script>
</body>
            </html>
